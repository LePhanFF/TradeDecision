
# === Embedded Educational Playbook Library (v9.4.3 - FULL) ===
# Coverage: Openings, IB/RE, Gaps (Gap & Go/Fade, RTH Gap Close), Spikes (up/down),
# Shapes (P, b, D), Morphs (P->B, b->B, D->P, D->b, Normal->Trend, Neutral->Extreme, Trend->DD),
# Extreme tests (LAB/LBF), HVN/LVN plays, Prominent POC magnet, dPOC relocations.
# Each play includes educational fields for chat JSON.

opening_playbooks:
  - id: OD_with_trend
    label: Open-Drive with higher-timeframe trend
    context: "Market blasts off from the open with conviction."
    why: "Dalton (pp. 192-202) - An Open-Drive reflects strong conviction from longer-term traders; fading it is fading stronger players."
    metrics: ["Opening_Type=OD","Open vs Prior: outside value/range","RE=Confirmed","dPOC migrating with drive","OTF active"]
    bias_confidence: "Bias: with drive. Confidence: Strong if RE confirmed and dPOC migrates; Moderate if provisional."
    entry: "First pullback that holds above/below open or IB edge with 15m acceptance."
    risk: "Stop if 30m closes back through open or one-timeframing breaks."
    sizing: "Full size only when OD + RE confirmed + dPOC migration; half size if provisional."
    targets: ["Nearest HVN in direction","IB projection"]
    conviction: "Strong when OD + RE confirmed + dPOC + peers aligned."

  - id: OTD_continuation
    label: Open-Test-Drive continuation
    context: "Market tests the opposite side early, rejects, then drives with conviction."
    why: "Dalton (pp. 192-202) - OTD is near OD in conviction after a quick test."
    metrics: ["Opening_Type=OTD","Opposite test rejection","RE success","15m->30m acceptance"]
    bias_confidence: "Bias: with drive. Confidence: High once acceptance confirmed."
    entry: "Reclaim of open or IB edge with acceptance (15m provisional -> 30m confirm)."
    risk: "Stop if back through open or if RE fails."
    sizing: "Moderate size until RE confirmed; scale when dPOC aligns."
    targets: ["IB projection","Next HVN"]
    conviction: "Strong if RE confirmed and dPOC supports."

  - id: ORR_reversal
    label: Open-Rejection-Reverse reversal
    context: "Early probe forms a tail, auction reverses through open."
    why: "Dalton (pp. 192-202) - ORR signals early rejection and a possible reversal day."
    metrics: ["Opening_Type=ORR","Single-print tail","Cross through open","OTF in new direction"]
    bias_confidence: "Bias: in reversal direction. Confidence: Moderate until OTF holds."
    entry: "Go-with after OTF prints begin in the new direction."
    risk: "Stop if OTF fails."
    sizing: "Smaller until OTF structure establishes."
    targets: ["Prior value edge","Opposite extreme"]
    conviction: "Moderate unless OTF holds strongly."

  - id: OA_balance
    label: Open-Auction balance
    context: "Two-sided rotation near the open; no early initiative."
    why: "Dalton (pp. 192-202) - OA is lowest conviction; expect balance/rotation."
    metrics: ["Opening_Type=OA","Inside prior value","Two-sided rotation","Limited elongation"]
    bias_confidence: "Bias: Two-sided. Confidence: Weak."
    entry: "Fade extremes toward POC/VA center."
    risk: "Stop if clear acceptance outside prior value or IB."
    sizing: "Small size in low-conviction conditions."
    targets: ["POC","Opposite VA edge"]
    conviction: "Weak by design."

ib_re_playbooks:
  - id: ib_breakout_success
    label: IB Breakout Success
    context: "Auction breaks the IB and holds outside."
    why: "Dalton (pp. 70-92) - RE + acceptance indicates new value and initiative control."
    metrics: ["IB size","RE direction","Acceptance (15m provisional -> 30m confirm)","Elongation/value drift"]
    bias_confidence: "Bias: with breakout direction. Confidence: Strong when confirmed."
    entry: "Pullback to IB edge that holds with 15m acceptance."
    risk: "Stop if 30m closes back inside IB."
    sizing: "Scale up with confirmation and dPOC migration."
    targets: ["Next distribution/HVN","IB projection"]
    conviction: "Strong on confirmed acceptance."

  - id: ib_breakout_failure_balance
    label: IB Breakout Failure -> Balance
    context: "Probe outside IB fails and returns inside; two-sided day likely."
    why: "Dalton (pp. 70-92) - Failed RE suggests balance and rotations."
    metrics: ["Failed RE","Return inside IB","Lack of elongation"]
    bias_confidence: "Bias: Two-sided. Confidence: Moderate."
    entry: "Fade IB extremes toward POC."
    risk: "Stop if subsequent RE succeeds with acceptance."
    sizing: "Normal size; tighter risk near edges."
    targets: ["POC","Opposite IB edge"]
    conviction: "Moderate; rotational expectations."

gap_playbooks:
  - id: gap_and_go_up
    label: Gap & Go Up
    context: "Open is outside prior range and continues higher."
    why: "Dalton (pp. 70-92, 192-202) - Out-of-balance opens often trend if accepted."
    metrics: ["Gap_Type=Outside_Prior_Range","Opening OD/OTD","RE Up","ON Too Short/Balanced","Acceptance"]
    bias_confidence: "Bias: Up. Confidence: Strong with acceptance and aligned ON."
    entry: "First pullback that holds open-test low/IB High/spike base with 15m acceptance."
    risk: "Stop if 15m/30m reclaim back inside prior range."
    sizing: "Full size with confirmation; reduce if prominent POC above."
    targets: ["IB measured move","Developing value highs"]
    conviction: "Strong with aligned context."

  - id: gap_and_go_down
    label: Gap & Go Down
    context: "Open is outside prior range and continues lower."
    why: "Dalton (pp. 70-92, 192-202) - Mirror logic on the downside."
    metrics: ["Gap_Type=Outside_Prior_Range","Opening OD/OTD","RE Down","ON Too Long/Balanced","Acceptance"]
    bias_confidence: "Bias: Down. Confidence: Strong with acceptance and aligned ON."
    entry: "First bounce that holds open-test high/IB Low/spike base with 15m acceptance."
    risk: "Stop if 15m/30m reclaim back inside prior range."
    sizing: "Full size with confirmation; reduce if prominent POC below."
    targets: ["IB measured move","Developing value lows"]
    conviction: "Strong with aligned context."

  - id: gap_fade_down_from_gap_up
    label: Gap Fade Down from Gap Up
    context: "Gap up fails and returns inside prior range."
    why: "Dalton (pp. 70-92) - Returning inside implies traverse toward opposite extreme."
    metrics: ["Gap_Type","OA/ORR","Early failure to extend","15m close back inside"]
    bias_confidence: "Bias: Fade down to value. Confidence: Moderate."
    entry: "Short back inside after failed retest."
    risk: "Stop if re-escape and hold back outside."
    sizing: "Moderate size."
    targets: ["Prior POC/VA center","Opposite extreme if accepted"]
    conviction: "Moderate; inventory correction."

  - id: gap_fade_up_from_gap_down
    label: Gap Fade Up from Gap Down
    context: "Gap down fails and returns inside prior range."
    why: "Dalton (pp. 70-92) - Mirror logic on return inside."
    metrics: ["Gap_Type","OA/ORR","Early failure to extend","15m close back inside"]
    bias_confidence: "Bias: Fade up to value. Confidence: Moderate."
    entry: "Long back inside after failed retest."
    risk: "Stop if re-escape and hold back outside."
    sizing: "Moderate size."
    targets: ["Prior POC/VA center","Opposite extreme if accepted"]
    conviction: "Moderate; inventory correction."

rth_gap_close_playbooks:
  - id: rth_gap_close_up_fade
    label: RTH Gap Close - Fade Down (from Gap Up)
    context: "D/Neutral day behavior: rotate toward prior RTH close and fill the gap."
    why: "Dalton (pp. 70-92) - Balanced days often fill gaps; failure to fill is information."
    metrics: ["RTH gap dir/size","Acceptance back inside","Peer gap-close confirmation"]
    bias_confidence: "Bias: Down toward prior close. Confidence: Strong if peers confirm."
    entry: "Short toward prior close once acceptance back inside is seen."
    risk: "Stop if re-escape above prior range with acceptance."
    sizing: "Normal size; scale if peers confirm."
    targets: ["Prior close","VA center"]
    conviction: "Strong with peer confirmation."

  - id: rth_gap_close_down_fade
    label: RTH Gap Close - Fade Up (from Gap Down)
    context: "D/Neutral day behavior: rotate toward prior RTH close and fill the gap."
    why: "Dalton (pp. 70-92) - Mirror logic for gap down."
    metrics: ["RTH gap dir/size","Acceptance back inside","Peer gap-close confirmation"]
    bias_confidence: "Bias: Up toward prior close. Confidence: Strong if peers confirm."
    entry: "Long toward prior close once acceptance back inside is seen."
    risk: "Stop if re-escape below prior range with acceptance."
    sizing: "Normal size; scale if peers confirm."
    targets: ["Prior close","VA center"]
    conviction: "Strong with peer confirmation."

spike_playbooks:
  - id: spike_next_day_up
    label: Next Day After Late Spike Up
    context: "Spike into the prior close; next-day test relative to spike base."
    why: "Dalton (pp. 103-157) - Spike base defines acceptance vs rejection."
    metrics: ["Spike present","Open vs Spike Base","Acceptance relative to base"]
    bias_confidence: "Bias: With spike if open/accept above base; against if below. Confidence: Strong when clear."
    entry: "Go-with above base on pullbacks; fade below base on failures."
    risk: "Stop if acceptance flips sides of the base."
    sizing: "Size with clarity of acceptance."
    targets: ["Spike high","Measured extensions"]
    conviction: "Strong if accepted."

  - id: spike_next_day_down
    label: Next Day After Late Spike Down
    context: "Down spike into the close; next-day test relative to spike base."
    why: "Dalton (pp. 103-157) - Mirror logic for down spikes."
    metrics: ["Spike present","Open vs Spike Base","Acceptance relative to base"]
    bias_confidence: "Bias: With spike if below base; against if above. Confidence: Strong when clear."
    entry: "Go-with below base on bounces; fade above base on failures."
    risk: "Stop if acceptance flips sides of the base."
    sizing: "Size with clarity of acceptance."
    targets: ["Spike low","Measured extensions"]
    conviction: "Strong if accepted."

shape_playbooks:
  - id: shape_P
    label: P-day Short Covering
    context: "Upper fatness/verticality from shorts covering; limited new buying."
    why: "Dalton (pp. 178-205) - Short covering is limited timeframe; continuation needs fresh value."
    metrics: ["Shape=P","Skew up","Thin lower tail","dPOC needs to migrate up for continuation"]
    bias_confidence: "Bias: Cautious long. Confidence: Weak unless new value forms."
    entry: "Buy pullbacks only after fresh acceptance above POC/IB High."
    risk: "Stop if 30m closes back below POC and dPOC rolls down."
    sizing: "Small until new value acceptance occurs."
    targets: ["Next upper node","Revert to POC if no value builds"]
    conviction: "Weak without new buyers."

  - id: shape_b
    label: b-day Long Liquidation
    context: "Lower fatness/verticality from longs liquidating; limited new selling."
    why: "Dalton (pp. 178-205) - Long liquidation is limited timeframe; continuation needs new value."
    metrics: ["Shape=b","Skew down","Thin upper tail","dPOC needs to migrate down for continuation"]
    bias_confidence: "Bias: Cautious short. Confidence: Weak unless new value forms."
    entry: "Sell bounces only after fresh acceptance below POC/IB Low."
    risk: "Stop if 30m closes back above POC and dPOC lifts."
    sizing: "Small until new value acceptance occurs."
    targets: ["Next lower node","Revert to POC if no value builds"]
    conviction: "Weak without new sellers."

  - id: shape_D
    label: D-day Balance
    context: "Fat center around POC; limited RE; stable dPOC."
    why: "Dalton (pp. 70-92, 178-205) - Balance days rotate around POC; mean reversion."
    metrics: ["Shape=D","High center fatness","Stable dPOC","Limited RE"]
    bias_confidence: "Bias: Two-sided. Confidence: Moderate."
    entry: "Fade extremes back toward POC/VA center; LAB/LBF at edges."
    risk: "Stop if acceptance outside balance (15m provisional -> 30m confirm)."
    sizing: "Normal size; scale at edges."
    targets: ["POC","Opposite box edge"]
    conviction: "Moderate by design."

morph_playbooks:
  - id: morph_P_to_B
    label: P to Balance (P->B)
    context: "P-day transitions into balance as center fattens."
    why: "Dalton (pp. 178-205) - Short covering exhausts; auction returns to balance."
    metrics: ["Shape morph P->B","dPOC stabilizes","Center fatness rises"]
    bias_confidence: "Bias: Two-sided. Confidence: Moderate."
    entry: "Switch from chase to fade extremes."
    risk: "Stop if new acceptance forms above prior upper distribution."
    sizing: "Normal size in balance."
    targets: ["POC","Opposite edge"]
    conviction: "Moderate; structure change."

  - id: morph_b_to_B
    label: b to Balance (b->B)
    context: "b-day transitions into balance as center fattens."
    why: "Dalton (pp. 178-205) - Long liquidation exhausts; auction returns to balance."
    metrics: ["Shape morph b->B","dPOC stabilizes","Center fatness rises"]
    bias_confidence: "Bias: Two-sided. Confidence: Moderate."
    entry: "Switch from chase to fade extremes."
    risk: "Stop if new acceptance forms below prior lower distribution."
    sizing: "Normal size in balance."
    targets: ["POC","Opposite edge"]
    conviction: "Moderate; structure change."

  - id: morph_D_to_P
    label: D to P (late breakout up)
    context: "Tight balance breaks higher late with acceptance."
    why: "Dalton (pp. 70-92) - Late initiative can create trend from balance."
    metrics: ["Tight balance box","15m acceptance above","RE Up","dPOC migration up"]
    bias_confidence: "Bias: Up. Confidence: High after acceptance."
    entry: "Go-with breakout; buy pullbacks to box top."
    risk: "Stop if return and acceptance back inside box."
    sizing: "Scale as acceptance persists."
    targets: ["IB projection","Next node"]
    conviction: "High if OTF develops."

  - id: morph_D_to_b
    label: D to b (late breakdown)
    context: "Tight balance breaks lower late with acceptance."
    why: "Dalton (pp. 70-92) - Mirror logic for downside."
    metrics: ["Tight balance box","15m acceptance below","RE Down","dPOC migration down"]
    bias_confidence: "Bias: Down. Confidence: High after acceptance."
    entry: "Go-with breakdown; sell bounces to box bottom."
    risk: "Stop if return and acceptance back inside box."
    sizing: "Scale as acceptance persists."
    targets: ["Next lower node"]
    conviction: "High if OTF develops."

  - id: morph_Normal_to_Trend
    label: Normal -> Trend morph
    context: "Normal day transitions into trend with later elongation."
    why: "Dalton (pp. 70-92, 192-202) - Rare but important transition when later initiative takes control."
    metrics: ["Day Type prev=Normal","Later elongation with acceptance","OTF begins"]
    bias_confidence: "Bias: With new trend. Confidence: High after OTF forms."
    entry: "Go-with on pullback; use OTF as guardrail."
    risk: "Stop on OTF break or return to IB."
    sizing: "Scale with OTF persistence."
    targets: ["Next nodes in direction"]
    conviction: "High once OTF persists."

  - id: morph_Neutral_to_Extreme
    label: Neutral -> Neutral-Extreme morph
    context: "Neutral becomes Neutral-Extreme into the close."
    why: "Dalton (pp. 70-92) - Close near an extreme often carries over if accepted."
    metrics: ["Day Type prev=Neutral","Late initiative to extreme","Close near extreme","Spike rules"]
    bias_confidence: "Bias: Toward the extreme. Confidence: High if spike accepted."
    entry: "Go-with; next day use spike base rules."
    risk: "Stop if acceptance fails at the extreme."
    sizing: "Moderate to large with acceptance."
    targets: ["End-of-day objective","Spike levels next day"]
    conviction: "High if accepted."

  - id: morph_Trend_to_DD
    label: Trend -> Double-Distribution morph
    context: "Midday pause builds a second distribution, then continuation."
    why: "Dalton (pp. 70-92) - DD forms when trend pauses, rebuilds energy, and continues."
    metrics: ["Trend earlier","Midday balance","Break from balance","Second auction develops"]
    bias_confidence: "Bias: With original trend. Confidence: High after break."
    entry: "Rejoin on break from midday balance."
    risk: "Stop if failure back into midday balance."
    sizing: "Scale with acceptance into second distribution."
    targets: ["Measured move from second distribution"]
    conviction: "High if clean DD forms."

extreme_tests:
  - id: look_above_fail
    label: Look Above and Fail (balance edge)
    context: "Probe above balance extreme fails and returns inside."
    why: "Dalton (pp. 70-92) - LAB/LBF often traverses to the opposite side."
    metrics: ["Balance box defined","Probe above","Return inside","No acceptance above"]
    bias_confidence: "Bias: Short back inside. Confidence: Moderate-High."
    entry: "Enter short after failure back inside."
    risk: "Stop if acceptance builds above the extreme."
    sizing: "Normal with tight risk at the edge."
    targets: ["Opposite balance extreme"]
    conviction: "Moderate-High."

  - id: look_below_fail
    label: Look Below and Fail (balance edge)
    context: "Probe below balance extreme fails and returns inside."
    why: "Dalton (pp. 70-92) - Mirror logic for below."
    metrics: ["Balance box defined","Probe below","Return inside","No acceptance below"]
    bias_confidence: "Bias: Long back inside. Confidence: Moderate-High."
    entry: "Enter long after failure back inside."
    risk: "Stop if acceptance builds below the extreme."
    sizing: "Normal with tight risk at the edge."
    targets: ["Opposite balance extreme"]
    conviction: "Moderate-High."

hvn_lvn_playbooks:
  - id: lvn_reject_to_hvn
    label: LVN Rejection -> Rotate to HVN
    context: "Price taps LVN, rejects, and rotates toward fat node."
    why: "Dalton (pp. 45-92) - Auctions avoid thin spots and rest at fat nodes."
    metrics: ["LVN tested","Rejection evidence","Nearest HVN known"]
    bias_confidence: "Bias: Toward HVN. Confidence: High when rejection is clear."
    entry: "Enter toward nearest HVN after rejection signal (wick/close)."
    risk: "Stop if acceptance builds through LVN."
    sizing: "Normal; tighten risk near LVN."
    targets: ["Nearest HVN","POC if closer"]
    conviction: "High with clean rejection."

  - id: lvn_break_accept
    label: LVN Break and Accept -> Traverse to Next Node
    context: "Price breaks a thin area and accepts beyond; moves fast to next node."
    why: "Dalton (pp. 45-92) - Once through thin areas, price often travels quickly."
    metrics: ["LVN broken","Acceptance beyond LVN","Next node mapped"]
    bias_confidence: "Bias: With break. Confidence: High when acceptance persists."
    entry: "Go-with toward next HVN/node."
    risk: "Stop on return back inside and loss of acceptance."
    sizing: "Scale with persistence beyond LVN."
    targets: ["Next HVN/node"]
    conviction: "High when LVN is cleanly accepted."

  - id: hvn_reject_back_to_balance
    label: HVN Rejection -> Back to Balance
    context: "Test into HVN fails; price returns to balance center."
    why: "Dalton (pp. 45-92) - HVNs can act like gravity or brick walls depending on participation."
    metrics: ["HVN tested","Rejection evidence","Balance center known"]
    bias_confidence: "Bias: Back to POC. Confidence: Moderate."
    entry: "Fade back toward POC after HVN rejection."
    risk: "Stop if acceptance persists inside HVN with elongation."
    sizing: "Moderate with tight risk."
    targets: ["POC","Opposite edge if rotation persists"]
    conviction: "Moderate unless rejection is violent."

risk_cautions:
  - id: prominent_poc_magnet
    label: Prominent POC Magnet
    context: "POC has many TPOs; acts like a magnet."
    why: "Dalton (pp. 165-225) - Wide means -> rotation around the mean."
    metrics: ["Prominent POC"]
    bias_confidence: "Bias: Mean-revert caution. Confidence: Low for momentum away."
    entry: "Reduce size trading away; consider mean-reversion."
    risk: "Stop if elongation away persists with acceptance."
    sizing: "Small when trading against magnet."
    targets: ["POC"]
    conviction: "Caution, not a standalone trade."

dpoc_relocation_playbooks:
  - id: dpoc_relocation_up
    label: dPOC Relocation Up
    context: "POC jumps higher and holds; new business area."
    why: "Dalton (pp. 45-92) - Value shift implies new center of balance."
    metrics: ["dPOC jump up","Acceptance at new POC"]
    bias_confidence: "Bias: Align with new center. Confidence: Strong if accepted."
    entry: "Buy pullbacks to new POC."
    risk: "Stop if return/acceptance at old POC."
    sizing: "Scale with acceptance at new center."
    targets: ["Next node above"]
    conviction: "Strong on relocation."

  - id: dpoc_relocation_down
    label: dPOC Relocation Down
    context: "POC jumps lower and holds; new business area."
    why: "Dalton (pp. 45-92) - Mirror logic lower."
    metrics: ["dPOC jump down","Acceptance at new POC"]
    bias_confidence: "Bias: Align with new center. Confidence: Strong if accepted."
    entry: "Sell bounces to new POC."
    risk: "Stop if return/acceptance at old POC."
    sizing: "Scale with acceptance at new center."
    targets: ["Next node below"]
    conviction: "Strong on relocation."
