# PROMPT_CODEGEN_NT8.txt
Updated: 2025-09-29 02:59 

## Hard Rules for Codegen
- No tuple generics; use Core DTOs.
- Single definition of Node, SinglePrint, DpocPoint, ProfileSnapshot in Core.
- UiHostWindow must be created on Application.Current.Dispatcher.Invoke + Show().
- Do not use NTWindow.MainWindow.
- Close UiHostWindow on its Dispatcher.BeginInvoke.
- Keep code inside namespace; braces matched.

## Canonical Start() block
```csharp
var disp = Application.Current != null ? Application.Current.Dispatcher : null;
if (disp != null)
{
    disp.Invoke(new Action(() =>
    {
        ui = new UiHostWindow();
        ui.Show();
    }));
}
else
{
    ui = new UiHostWindow();
    ui.Show();
}
```
